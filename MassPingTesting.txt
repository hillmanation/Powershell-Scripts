$IPs = ''
$startTime = Get-Date
$date = Get-Date -format "MM_dd_yyyy"
$stop = 0
$delay = 0

##Define log location and system reboot list
$root = "\_Hillman\Win 10 Testing"
$offlineLog = $root + "\OfflineLog_" + $date + ".txt"

"Script starting at $startTime, testing connections to locations associated with the shared drives:`r`n`r`n" | Add-Content $offlineLog

DO
{

    ForEach ( $IP in $IPs) {
            $now = Get-Date -Format "MM-dd-yyyy HH:mm:ss"
            If (!(Test-Connection -ComputerName $IP -Count 1 -Quiet)) { $stop++; "No connection found for address $IP at $now" | Add-Content $offlineLog }
            
            Else { echo "Tested address $IP, currently reachable at $now.`n`n" }
    }
    $delay++
    If (($delay % 10000) -eq 0) { Start-Sleep -Seconds 7500 }
    ElseIf (($delay % 2000) -eq 0) { Start-Sleep -Seconds 5700 }

} Until ( $stop -eq 100  )

$now = Get-Date -Format "MM-dd-yyyy HH:mm:ss"
$endTime = Get-Date
$elapsed = (($endTime - $startTime).totalSeconds)

"`r`nScript ended at $now.`r`nElapsed time $elapsed seconds." | Add-Content $offlineLog