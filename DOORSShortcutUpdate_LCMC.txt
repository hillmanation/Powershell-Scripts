Set-ExecutionPolicy -ExecutionPolicy Unrestricted

$computers =  (Get-ADComputer -filter * -Properties Name,OperatingSystem -SearchBase "OU=Windows 10 LCMC VDIs,OU=Win 10 VDI,OU=Windows 10,OU=Computers,OU=Compass Blue,DC=EVAV,DC=AE,DC=GE,DC=COM" -SearchScope Subtree | where { $_.OperatingSystem -like "*Windows*" -and $_.Name -notlike "*GOLD*" } | Select-Object Name).Name

ForEach ( $computer in $computers ) {
    
    If ((Test-Connection -ComputerName $computer -Count 1 -Quiet) -eq $True) {

        $shell = New-Object -COM WScript.Shell
        $shortcut = $shell.CreateShortcut("\\$computer\c$\Users\Public\Desktop\IBM Rational DOORS 9.6.lnk")
        $shortcut.TargetPath = "C:\Program Files\IBM\Rational\DOORS\9.6\bin\doors.exe"
        $shortcut.Arguments = " -O r -o r -d 36677@doors-2.evav.ae.ge.com"
        $shortcut.Save()  }
    Else { $computer | Add-Content "\\AETPData\OurStuff\_Hillman\DOORSUpdateOffline.txt"  }

}