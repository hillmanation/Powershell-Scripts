import-module activedirectory

$jabberlist = Import-CSV -Path "\_Hillman\Script Output\Jabber Installed.csv"
$hasjabber = @()
$missingjabber = @()

$jabberlist | % { $trash,$name = $_.Name.split('\'); $hasjabber += $name }

$compasscomputers = (Get-ADComputer -filter * -Properties Name,OperatingSystem,DistinguishedName | Where { $_.OperatingSystem -like "*Windows*" -and $_.OperatingSystem -notlike "*server*" -and $_.DistinguishedName -like "*Windows 10*" -and $_.DistinguishedName -notlike "*LAPS*" }).Name | Sort-Object -Property Name

ForEach ($computer in $compasscomputers) {

    If ($hasjabber -notcontains $computer) { $missingjabber += [pscustomobject]@{ Name = $computer } }

}

$missingjabber = $missingjabber | Sort-Object -Property Name